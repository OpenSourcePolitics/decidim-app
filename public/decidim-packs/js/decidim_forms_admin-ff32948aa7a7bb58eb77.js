!function(){var e,t={53232:function(e,t,n){"use strict";n(22327);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.listSelector=t.listSelector,this.minItems=t.minItems,this.hideOnMinItemsOrLessSelector=t.hideOnMinItemsOrLessSelector,this.run()}var t,n,r;return t=e,(n=[{key:"run",value:function(){var e=$(this.listSelector),t=e.find(this.hideOnMinItemsOrLessSelector);e.length<=this.minItems?t.hide():t.show()}}])&&o(t.prototype,n),r&&o(t,r),e}();function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.wrapperSelector=t.wrapperSelector,this.selectSelector=t.selectSelector,this.listSelector=t.listSelector}var t,n,i;return t=e,(n=[{key:"run",value:function(){var e=$(this.listSelector),t=e.parents(this.wrapperSelector).find(this.selectSelector);t.find("option").slice(1).remove();for(var n=2;n<=e.length;n+=1)$('<option value="'.concat(n,'">').concat(n,"</option>")).appendTo(t)}}])&&l(t.prototype,n),i&&l(t,i),e}();function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,e),this.$source=t.source,this.$select=t.select,this.sourceToParams=t.sourceToParams,this.run()}var t,n,i;return t=e,(n=[{key:"run",value:function(){this.$source.on("change",this._onSourceChange.bind(this)),this._onSourceChange()}},{key:"_onSourceChange",value:function(){var e=this.$select,t=this.sourceToParams(this.$source),n=this.$source.data("url");$.getJSON(n,t,(function(t){e.find("option:not([value=''])").remove();var n=e.data("selected");t.forEach((function(t){var i=$('<option value="'.concat(t.id,'">').concat(t.body,"</option>")).appendTo(e);t.id===n&&i.attr("selected",!0)})),n&&e.val(n)}))}}])&&s(t.prototype,n),i&&s(t,i),e}();function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(this,e),this.inputSelector=t.inputSelector,this.targetSelector=t.targetSelector,this.maxLength=t.maxLength,this.omission=t.omission,this.placeholder=t.placeholder,this._bindEvent(),this._run()}var t,n,i;return t=e,(n=[{key:"_run",value:function(){var e=$(this.inputSelector),t=$(this.targetSelector),n=e.val()||this.placeholder;n.length>this.maxLength&&(n=n.substring(0,this.maxLength-this.omission.length)+this.omission),t.text(n)}},{key:"_bindEvent",value:function(){$(this.inputSelector).on("change",this._run.bind(this))}}])&&h(t.prototype,n),i&&h(t,i),e}();function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var S=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this,e),this.listSelector=t.listSelector,this.hideOnFirstSelector=t.hideOnFirstSelector,this.hideOnLastSelector=t.hideOnLastSelector,this.run()}var t,n,i;return t=e,(n=[{key:"run",value:function(){var e=$(this.listSelector),t=this.hideOnFirstSelector,n=this.hideOnLastSelector;if(1===e.length){var i=e.first();i.find(t).hide(),i.find(n).hide()}else e.each((function(i,o){o.id===e.first().attr("id")?($(o).find(t).hide(),$(o).find(n).show()):o.id===e.last().attr("id")?($(o).find(n).hide(),$(o).find(t).show()):($(o).find(n).show(),$(o).find(t).show())}))}}])&&m(t.prototype,n),i&&m(t,i),e}();function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};w(this,e),this.listSelector=t.listSelector,this.labelSelector=t.labelSelector,this.onPositionComputed=t.onPositionComputed,this.run()}var t,n,i;return t=e,(n=[{key:"run",value:function(){var e=this;$(this.listSelector).each((function(t,n){var i=$(n).find(e.labelSelector),o=i.html();o.match(/#(\d+)/)?i.html(o.replace(/#(\d+)/,"#".concat(t+1))):i.html("".concat(o," #").concat(t+1)),e.onPositionComputed&&e.onPositionComputed(n,t)}))}}])&&b(t.prototype,n),i&&b(t,i),e}(),F=n(64112);var y=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),$(t).length>0&&(0,F.Z)(t,n)[0].addEventListener("sortupdate",(function(e){var t=$(e.target).children();n.onSortUpdate&&n.onSortUpdate(t)}))};function q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var k=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};q(this,e),this.wrapperSelector=t.wrapperSelector,this.containerSelector=t.containerSelector,this.fieldSelector=t.fieldSelector,this.addFieldButtonSelector=t.addFieldButtonSelector,this.addSeparatorButtonSelector=t.addSeparatorButtonSelector,this.fieldTemplateSelector=t.fieldTemplateSelector,this.separatorTemplateSelector=t.separatorTemplateSelector,this.removeFieldButtonSelector=t.removeFieldButtonSelector,this.moveUpFieldButtonSelector=t.moveUpFieldButtonSelector,this.moveDownFieldButtonSelector=t.moveDownFieldButtonSelector,this.onAddField=t.onAddField,this.onRemoveField=t.onRemoveField,this.onMoveUpField=t.onMoveUpField,this.onMoveDownField=t.onMoveDownField,this.placeholderId=t.placeholderId,this.elementCounter=0,this._enableInterpolation(),this._activateFields(),this._bindEvents()}var t,n,i;return t=e,n=[{key:"_enableInterpolation",value:function(){$.fn.replaceAttribute=function(e,t,n){return $(this).find("[".concat(e,"*=").concat(t,"]")).addBack("[".concat(e,"*=").concat(t,"]")).each((function(i,o){$(o).attr(e,$(o).attr(e).replace(t,n))})),this},$.fn.template=function(e,t){var n=$(this).find("template, .decidim-template");n.length>0&&n.html((function(n,i){return $(i).template(e,t)[0].outerHTML}));var i=$(this).find("[data-template]");return i.length>0&&i.each((function(n,i){var o=$(i),r=$(o.data("template")),a=$(r[0].outerHTML),l="".concat(r.attr("id"),"-").concat(t),c="#".concat(l);a.attr("id",l),o.attr("data-template",c).data("template",c),r.after(a),a.html((function(n,i){return $(i).template(e,t)[0].outerHTML}))})),$(this).replaceAttribute("id",e,t),$(this).replaceAttribute("name",e,t),$(this).replaceAttribute("data-tabs-content",e,t),$(this).replaceAttribute("for",e,t),$(this).replaceAttribute("tabs_id",e,t),$(this).replaceAttribute("href",e,t),this}}},{key:"_bindEvents",value:function(){var e=this;$(this.wrapperSelector).on("click",this.addFieldButtonSelector,(function(t){return e._bindSafeEvent(t,(function(){return e._addField(e.fieldTemplateSelector)}))})),this.addSeparatorButtonSelector&&$(this.wrapperSelector).on("click",this.addSeparatorButtonSelector,(function(t){return e._bindSafeEvent(t,(function(){return e._addField(e.separatorTemplateSelector)}))})),$(this.wrapperSelector).on("click",this.removeFieldButtonSelector,(function(t){return e._bindSafeEvent(t,(function(t){return e._removeField(t)}))})),this.moveUpFieldButtonSelector&&$(this.wrapperSelector).on("click",this.moveUpFieldButtonSelector,(function(t){return e._bindSafeEvent(t,(function(t){return e._moveUpField(t)}))})),this.moveDownFieldButtonSelector&&$(this.wrapperSelector).on("click",this.moveDownFieldButtonSelector,(function(t){return e._bindSafeEvent(t,(function(t){return e._moveDownField(t)}))}))}},{key:"_bindSafeEvent",value:function(e,t){e.preventDefault(),e.stopPropagation();try{return t(e.target)}catch(n){return console.error(n),n}}},{key:"_addField",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".decidim-template",t=$(this.wrapperSelector),n=t.find(this.containerSelector),i=t.data("template"),o=null;i&&(o=$(i)),(null===o||o.length<1)&&(o=t.children("template, ".concat(e)));var r=$(o.html()).template(this.placeholderId,this._getUID());r.find("ul.tabs").attr("data-tabs",!0);var a=n.find(this.fieldSelector).last();a.length>0?a.after(r):r.appendTo(n),r.foundation(),this.onAddField&&this.onAddField(r)}},{key:"_removeField",value:function(e){var t=$(e).parents(this.fieldSelector);if(t.find("input").filter((function(e,t){return t.name.match(/id/)})).length>0){var n=t.find("input").filter((function(e,t){return t.name.match(/delete/)}));n.length>0&&$(n[0]).val(!0),t.addClass("hidden"),t.hide()}else t.remove();this.onRemoveField&&this.onRemoveField(t)}},{key:"_moveUpField",value:function(e){var t=$(e).parents(this.fieldSelector);t.prev().before(t),this.onMoveUpField&&this.onMoveUpField(t)}},{key:"_moveDownField",value:function(e){var t=$(e).parents(this.fieldSelector);t.next().after(t),this.onMoveDownField&&this.onMoveDownField(t)}},{key:"_activateFields",value:function(){var e=this,t=$(this.wrapperSelector).find(this.containerSelector);t.append(t.find("script")),$(this.fieldSelector).each((function(t,n){$(n).template(e.placeholderId,e._getUID()),$(n).find("ul.tabs").attr("data-tabs",!0)}))}},{key:"_getUID",value:function(){return this.elementCounter+=1,(new Date).getTime()+this.elementCounter}}],n&&_(t.prototype,n),i&&_(t,i),e}();function O(e){return new k(e)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var B=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};C(this,e),this.controllerField=t.controllerField,this.wrapperSelector=t.wrapperSelector,this.dependentFieldsSelector=t.dependentFieldsSelector,this.dependentInputSelector=t.dependentInputSelector,this.enablingCondition=t.enablingCondition,this._bindEvent(),this._run()}var t,n,i;return t=e,(n=[{key:"_run",value:function(){var e=this.controllerField,t=e.parents(this.wrapperSelector).find(this.dependentFieldsSelector),n=t.find(this.dependentInputSelector);this.enablingCondition(e)?(n.prop("disabled",!1),t.show()):(n.prop("disabled",!0),t.hide())}},{key:"_bindEvent",value:function(){var e=this;this.controllerField.on("change",(function(){e._run()}))}}])&&x(t.prototype,n),i&&x(t,i),e}();function T(e){return new B(e)}var I=n(61246);window.Decidim.createEditableForm=function(){var e=".questionnaire-question",t=".questionnaire-question-answer-option",n=".questionnaire-question-answer-options",i=".remove-answer-option",o=".questionnaire-question-matrix-row",a=".questionnaire-question-matrix-rows",l=".remove-matrix-row",d=".questionnaire-question-max-choices",s=".questionnaire-question-display-condition",f=".questionnaire-question-display-conditions",h=".remove-display-condition",v="select[name$=\\[decidim_condition_question_id\\]]",m="select[name$=\\[condition_type\\]]",w="input[name$=\\[deleted\\]]",b=new S({listSelector:".questionnaire-question:not(.hidden)",hideOnFirstSelector:".move-up-question",hideOnLastSelector:".move-down-question"}),F=new g({listSelector:".questionnaire-question:not(.hidden)",labelSelector:".card-title span:first",onPositionComputed:function(t,n){$(t).find("input[name$=\\[position\\]]:not([name*=\\[matrix_rows\\]])").val(n),b.run(),$(e).each((function(e,t){var n=$(t);e?(n.find(f).find(w).val("false"),n.find(f).show()):(n.find(f).find(w).val("true"),n.find(f).hide())}))}}),q=["single_option","multiple_option","sorting","matrix_single","matrix_multiple"],_=["matrix_single","matrix_multiple"],k=function(){new y(".questionnaire-questions-list:not(.published)",{handle:".question-divider",placeholder:'<div style="border-style: dashed; border-color: #000"></div>',forcePlaceholderSize:!0,onSortUpdate:function(){F.run(),b.run()}})},C=function(e){var t,n="#".concat(e," .question-title-statement"),i=$(n).data("locale"),o=$(n).data("max-length"),r=$(n).data("omission"),a=$(n).data("placeholder");return t={inputSelector:"#".concat(e," input[name$=\\[body_").concat(i,"\\]]"),targetSelector:n,maxLength:o,omission:r,placeholder:a},new p(t)},x=function(o){var a=function(t){return new r({wrapperSelector:e,listSelector:"#".concat(t," ").concat(n," .questionnaire-question-answer-option:not(.hidden)"),minItems:2,hideOnMinItemsOrLessSelector:i})}(o),l=function(t){return new c({wrapperSelector:e,selectSelector:"".concat(d," select"),listSelector:"#".concat(t," ").concat(n," .questionnaire-question-answer-option:not(.hidden)")})}(o);return O({placeholderId:"questionnaire-question-answer-option-id",wrapperSelector:"#".concat(o," ").concat(n),containerSelector:".questionnaire-question-answer-options-list",fieldSelector:t,addFieldButtonSelector:".add-answer-option",fieldTemplateSelector:".decidim-answer-option-template",removeFieldButtonSelector:i,onAddField:function(){a.run(),l.run()},onRemoveField:function(){a.run(),l.run()}})},B={},E={},P=function(e){return q.indexOf(e)>=0},D=function(e){return _.indexOf(e)>=0},U=function(e){var t=e.options[e.selectedIndex];return $(t).data("type")},L=function(e){var t=e.find(v),n=U(t[0]),i=P(n),o=["answered","not_answered"];i&&(o.push("equal"),o.push("not_equal")),o.push("match");var r=e.find(m);r.find("option").each((function(e,t){var n=$(t),i=n.val();i&&(n.show(),o.indexOf(i)<0&&n.hide())})),o.indexOf(r.val())<0&&r.val(o[0]),r.trigger("change")},M=function(e){var t=e.find(m).val(),n=e.find(".questionnaire-question-display-condition-value"),i=e.find(".questionnaire-question-display-condition-answer-option"),o=e.find(v),r=U(o[0]),a=P(r);"match"===t?n.show():n.hide(),!a||"not_equal"!==t&&"equal"!==t?i.hide():i.show()},A=function(e){var t=function(e){return new u({source:e.find(v),select:e.find("select[name$=\\[decidim_answer_option_id\\]]"),sourceToParams:function(e){return{id:e.val()}}})}(e);t.run(),e.find(v).on("change",(function(){L(e)})),e.find(m).on("change",(function(){M(e)})),M(e),L(e)},j={},R=function(i){var r=i.attr("id"),c=i.find("select[name$=\\[question_type\\]]");!function(e){var t=e.find(".collapsible");if(t.length>0){var n=t.attr("id").replace("-question-card",""),i="".concat(n,"-question-card button--collapse-question-").concat(n," button--expand-question-").concat(n);e.find(".question--collapse").data("toggle",i)}}(i),C(r),T({controllerField:c,wrapperSelector:e,dependentFieldsSelector:n,dependentInputSelector:"".concat(t," input"),enablingCondition:function(e){return P(e.val())}}),T({controllerField:c,wrapperSelector:e,dependentFieldsSelector:d,dependentInputSelector:"select",enablingCondition:function(e){return"multiple_option"===e.val()||"matrix_multiple"===e.val()}}),T({controllerField:c,wrapperSelector:e,dependentFieldsSelector:a,dependentInputSelector:"".concat(o," input"),enablingCondition:function(e){return D(e.val())}}),B[r]=x(r),E[r]=function(e){return O({placeholderId:"questionnaire-question-matrix-row-id",wrapperSelector:"#".concat(e," ").concat(a),containerSelector:".questionnaire-question-matrix-rows-list",fieldSelector:o,addFieldButtonSelector:".add-matrix-row",fieldTemplateSelector:".decidim-matrix-row-template",removeFieldButtonSelector:l,onAddField:function(){},onRemoveField:function(){}})}(r),j[r]=function(e){return O({placeholderId:"questionnaire-question-display-condition-id",wrapperSelector:"#".concat(e," ").concat(f),containerSelector:".questionnaire-question-display-conditions-list",fieldSelector:s,addFieldButtonSelector:".add-display-condition",removeFieldButtonSelector:h,onAddField:function(e){A(e)},onRemoveField:function(){}})}(r);var u=B[r],p=E[r],v=function(){P(c.val())&&(0===c.parents(e).find(t).length&&(u._addField(),u._addField()));D(c.val())&&(0===c.parents(e).find(o).length&&(p._addField(),p._addField()))};c.on("change",v),v()};O({placeholderId:"questionnaire-question-id",wrapperSelector:".questionnaire-questions",containerSelector:".questionnaire-questions-list",fieldSelector:e,addFieldButtonSelector:".add-question",addSeparatorButtonSelector:".add-separator",fieldTemplateSelector:".decidim-question-template",separatorTemplateSelector:".decidim-separator-template",removeFieldButtonSelector:".remove-question",moveUpFieldButtonSelector:".move-up-question",moveDownFieldButtonSelector:".move-down-question",onAddField:function(e){R(e),k(),e.find(".editor-container").each((function(e,t){(0,I.Z)(t)})),F.run(),b.run()},onRemoveField:function(e){F.run(),b.run(),e.find(i).each((function(t,n){B[e.attr("id")]._removeField(n)})),e.find(l).each((function(t,n){E[e.attr("id")]._removeField(n)})),e.find(h).each((function(t,n){j[e.attr("id")]._removeField(n)}))},onMoveUpField:function(){F.run(),b.run()},onMoveDownField:function(){F.run(),b.run()}}),k(),$(e).each((function(e,t){var n=$(t);!function(e){"true"===e.find("input[name$=\\[deleted\\]]").val()&&(e.addClass("hidden"),e.hide())}(n),R(n)})),$(s).each((function(e,t){var n=$(t);A(n)})),F.run(),b.run()}},22327:function(){window,$("button.collapse-all").on("click",(function(){$(".collapsible").addClass("hide"),$(".question--collapse .icon-expand").removeClass("hide"),$(".question--collapse .icon-collapse").addClass("hide")})),$("button.expand-all").on("click",(function(){$(".collapsible").removeClass("hide"),$(".question--collapse .icon-expand").addClass("hide"),$(".question--collapse .icon-collapse").removeClass("hide")}))}},n={};function i(e){var o=n[e];if(void 0!==o)return o.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,i),r.exports}i.m=t,e=[],i.O=function(t,n,o,r){if(!n){var a=1/0;for(s=0;s<e.length;s++){n=e[s][0],o=e[s][1],r=e[s][2];for(var l=!0,c=0;c<n.length;c++)(!1&r||a>=r)&&Object.keys(i.O).every((function(e){return i.O[e](n[c])}))?n.splice(c--,1):(l=!1,r<a&&(a=r));if(l){e.splice(s--,1);var d=o();void 0!==d&&(t=d)}}return t}r=r||0;for(var s=e.length;s>0&&e[s-1][2]>r;s--)e[s]=e[s-1];e[s]=[n,o,r]},i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={985:0};i.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,r,a=n[0],l=n[1],c=n[2],d=0;if(a.some((function(t){return 0!==e[t]}))){for(o in l)i.o(l,o)&&(i.m[o]=l[o]);if(c)var s=c(i)}for(t&&t(n);d<a.length;d++)r=a[d],i.o(e,r)&&e[r]&&e[r][0](),e[a[d]]=0;return i.O(s)},n=self.webpackChunkapp=self.webpackChunkapp||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var o=i.O(void 0,[112,335],(function(){return i(53232)}));o=i.O(o)}();
//# sourceMappingURL=decidim_forms_admin-ff32948aa7a7bb58eb77.js.map