!function(){var e={12581:function(e,t,n){var i={"./decidim/gamification/badges/decidim_gamification_badges_attended_meetings.svg":57197,"./decidim/meetings/decidim_meetings.svg":55881};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}o.keys=function(){return Object.keys(i)},o.resolve=a,e.exports=o,o.id=12581},57197:function(e,t,n){"use strict";e.exports=n.p+"media/images/decidim_gamification_badges_attended_meetings-0a385f1bbe5a6e378d14.svg"},55881:function(e,t,n){"use strict";e.exports=n.p+"media/images/decidim_meetings-f1cb40f132fbc2fa9a00.svg"}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/decidim-packs/",function(){"use strict";function e(e,t,n){var i="".concat(e,"Name");if(n[i])return n[i];var o=t.attr("name"),a=/\[[^\]]+\]$/;return o.match(a)?o.replace(a,"[".concat(e,"]")):e}function t(t,n,i){var o=$.extend({},n),a=t.attr("id").split("_");a.pop();var r="".concat(a.join("_")),l="latitude",c="longitude";t.length>0&&(l=e("latitude",t,o),c=e("longitude",t,o));var u=$.extend({latitudeId:"".concat(r,"_latitude"),longitudeId:"".concat(r,"_longitude"),latitudeName:l,longitudeName:c},n),s=!1,d=function(e){!function(){var e=$("#".concat(u.latitudeId));e.length<1&&(e=$('<input type="hidden" name="'.concat(u.latitudeName,'" id="').concat(u.latitudeId,'" />')),t.after(e));var n=$("#".concat(u.longitudeId));n.length<1&&(n=$('<input type="hidden" name="'.concat(u.longitudeName,'" id="').concat(u.longitudeId,'" />')),t.after(n))}(),$("#".concat(u.latitudeId)).val(e[0]).attr("value",e[0]),$("#".concat(u.longitudeId)).val(e[1]).attr("value",e[1])};t.on("change.decidim",(function(){s||($("#".concat(u.latitudeId)).val("").removeAttr("value"),$("#".concat(u.longitudeId)).val("").removeAttr("value"))})),t.on("geocoder-suggest-coordinates.decidim",(function(e,t){d(t),s=!0,i(t)}));var f="".concat(t.data("coordinates")).split(",").map(parseFloat);Array.isArray(f)&&2===f.length&&d(f)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}$((function(){var e=$("#meeting_address");e.length>0&&t(e);var n=$(".meetings_form");if(n.length>0){var i=n.find("#meeting_type_of_meeting"),o=n.find(".field[data-meeting-type='online']"),a=n.find(".field[data-meeting-type='in_person']"),r=function(e,t,n){var i=e.val();"hybrid"===i?t.show():(t.hide(),i===n&&t.show())};i.on("change",(function(e){var t=$(e.target);r(t,o,"online"),r(t,a,"in_person")})),r(i,o,"online"),r(i,a,"in_person");var l=n.find("#meeting_registration_type"),c=n.find("#meeting_registration_terms"),u=n.find("#meeting_registration_url"),s=n.find("#meeting_available_slots");l.on("change",(function(e){var t=$(e.target);r(t,s,"on_this_platform"),r(t,c,"on_this_platform"),r(t,u,"on_different_platform")})),r(l,s,"on_this_platform"),r(l,c,"on_this_platform"),r(l,u,"on_different_platform")}}));var a=window.$,r="open",l=function(){function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i(this,e),this.$element=t,this.$counter=o,this.questionsUrl=n.questionsUrl,this.pollingInterval=n.pollingInterval||5e3,this.mounted=!1,this.questions={}}var t,n,l;return t=e,(n=[{key:"isMounted",value:function(){return this.mounted}},{key:"mountComponent",value:function(){this.$element.length>0&&!this.mounted&&(this.mounted=!0,this._fetchQuestions())}},{key:"unmountComponent",value:function(){this.mounted&&(this.mounted=!1,this._stopPolling(),this.$element.html(""))}},{key:"_fetchQuestions",value:function(){var e=this;this._storeQuestionState(this.$element),a.ajax({url:this.questionsUrl,method:"GET",contentType:"application/javascript"}).done((function(){e._updateCounter(),e._setQuestionsState(e.$element),e._pollQuestions()}))}},{key:"_storeQuestionState",value:function(e){var t=this;a("[data-question]",e).each((function(e,n){var i=a(n),o=i.data("question");!0===i[0].open?t.questions[o]=r:t.questions[o]="closed"}))}},{key:"_setQuestionsState",value:function(e){var t=this;a("[data-question]",e).each((function(e,n){t._setQuestionState(a(n))}))}},{key:"_setQuestionState",value:function(e){var t=e.data("question"),n=this.questions[t];n?n===r&&e.prop(r,!0):e.addClass("is-new")}},{key:"_pollQuestions",value:function(){var e=this;this._stopPolling(),this.pollTimeout=setTimeout((function(){e._fetchQuestions()}),this.pollingInterval)}},{key:"_stopPolling",value:function(){this.pollTimeout&&clearTimeout(this.pollTimeout)}},{key:"_updateCounter",value:function(){if(this.$counter){var e=this.$element.find("details").length;this.$counter.html("(".concat(e,")"))}}}])&&o(t.prototype,n),l&&o(t,l),e}(),c="is-open";function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}$((function(){var e=$("[data-decidim-meetings-poll]"),t=$("#visible-questions-count"),n=new l(e,e.data("decidim-meetings-poll"),t);$(".meeting-polls__action-list").on("click",(function(t){t.preventDefault(),n.isMounted()?($(t.target).removeClass(c),e.removeClass(c),n.unmountComponent()):($(t.target).addClass(c),e.addClass(c),n.mountComponent())}));var i=$("[data-decidim-admin-meetings-poll]"),o=new l(i,i.data("decidim-admin-meetings-poll"));$(".meeting-polls__action-administrate").on("click",(function(e){e.preventDefault(),o.isMounted()?($(e.target).removeClass(c),i.removeClass(c),o.unmountComponent()):($(e.target).addClass(c),i.addClass(c),o.mountComponent())}))}));var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,e),this.wrapperField=t.wrapperField,this.controllerFieldSelector=t.controllerFieldSelector,this.dependentInputSelector=t.dependentInputSelector,this.controllerSelector=this.wrapperField.find(this.controllerFieldSelector),this._bindEvent(),this._run()}var t,n,i;return t=e,(n=[{key:"_run",value:function(){var e=this;this.controllerSelector.each((function(t,n){var i=$(n),o=i.is(":checked");i.parents("div.collection-input").find(e.dependentInputSelector).prop("disabled",!o)}))}},{key:"_bindEvent",value:function(){var e=this;this.controllerSelector.on("change",(function(){e._run()}))}}])&&s(t.prototype,n),i&&s(t,i),e}();function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(this,e),this.wrapperField=t.wrapperField,this._bindEvent(),this._order(),this._normalize()}var t,n,i;return t=e,(n=[{key:"_order",value:function(){var e=$(this.wrapperField).find(".collection-input").length;$(this.wrapperField).find(".collection-input").each((function(t,n){for(var i=$(n).find("input[name$=\\[position\\]]"),o=i.val()?parseInt(i.val(),10):e,a=$(n).next();a.length>0;){var r=a.find("input[name$=\\[position\\]]");o>(r.val()?parseInt(r.val(),10):e)&&a.insertBefore($(n)),a=a.next()}}))}},{key:"_findLastPosition",value:function(){var e=0;return $(this.wrapperField).find(".collection-input").each((function(t,n){var i=$(n).find("input[name$=\\[position\\]]"),o=parseInt(i.val(),10);o>e&&(e=o)})),e}},{key:"_normalize",value:function(){$(this.wrapperField).find(".collection-input .position").each((function(e,t){var n=$(t).parent().find("input[name$=\\[position\\]]");n.val()&&(n.val(e),n.prop("disabled",!1),$(t).html("".concat(e+1,". ")))}))}},{key:"_bindEvent",value:function(){var e=this;$(this.wrapperField).find("input[type=checkbox]").on("change",(function(t){var n=$(t.target).parents("label"),i=n.find(".position"),o=n.find("input[name$=\\[position\\]]"),a=e._findLastPosition();t.target.checked?(o.val(a+1),o.prop("disabled",!1),i.html(a+1)):(o.val(""),o.prop("disabled",!0),i.html("")),e._order(),e._normalize()}))}}])&&h(t.prototype,n),i&&h(t,i),e}();function v(e){return v="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function y(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),e}var w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m(this,e),this.wrapperField=t.wrapperField,this.type=t.type,this.conditionQuestion=t.conditionQuestion,this.answerOption=t.answerOption,this.mandatory=t.mandatory,this.value=t.value,this.onFulfilled=t.onFulfilled,this.bindEvent()}return y(e,[{key:"bindEvent",value:function(){this.checkCondition(),this.getInputsToListen().on("change",this.checkCondition.bind(this))}},{key:"getInputValue",value:function(){var e=$(".question[data-question-id='".concat(this.conditionQuestion,"']")),t=e.find("textarea, input[type='text']:not([name$=\\[custom_body\\]])");if(t.length)return t.val();var n=[];return e.find(".radio-button-collection, .check-box-collection").find(".collection-input").each((function(e,t){var i=$(t).find("input[name$=\\[body\\]]");if(i.is(":checked")){var o=$(t).find("input[name$=\\[custom_body\\]]").val(),a=i.val(),r=$(t).find("input[name$=\\[answer_option_id\\]]").val();n.push({id:r,value:a,text:o})}})),n}},{key:"getInputsToListen",value:function(){var e=$(".question[data-question-id='".concat(this.conditionQuestion,"']")),t=e.find("textarea, input[type='text']:not([name$=\\[custom_body\\]])");return t.length?t:e.find(".collection-input").find("input:not([type='hidden'])")}},{key:"checkAnsweredCondition",value:function(e){return"object"!==v(e)?Boolean(e):Boolean(e.some((function(e){return e.value})))}},{key:"checkNotAnsweredCondition",value:function(e){return!this.checkAnsweredCondition(e)}},{key:"checkEqualCondition",value:function(e){var t=this;return!!e.length&&e.some((function(e){return e.id===t.answerOption.toString()}))}},{key:"checkNotEqualCondition",value:function(e){var t=this;return!!e.length&&e.every((function(e){return e.id!==t.answerOption.toString()}))}},{key:"checkMatchCondition",value:function(e){var t=new RegExp(this.value,"i");return"object"!==v(e)?Boolean(e.match(t)):e.some((function(e){return e.text?e.text.match(t):e.value.match(t)}))}},{key:"checkCondition",value:function(){var e=this.getInputValue(),t=!1;switch(this.type){case"answered":t=this.checkAnsweredCondition(e);break;case"not_answered":t=this.checkNotAnsweredCondition(e);break;case"equal":t=this.checkEqualCondition(e);break;case"not_equal":t=this.checkNotEqualCondition(e);break;case"match":t=this.checkMatchCondition(e);break;default:t=!1}this.onFulfilled(t)}}]),e}(),_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m(this,e),this.wrapperField=t.wrapperField,this.conditions={},this.showCount=0,this.initializeConditions()}return y(e,[{key:"initializeConditions",value:function(){var e=this;this.wrapperField.find(".display-condition").each((function(t,n){var i=$(n),o=i.data("id");e.conditions[o]={},e.conditions[o]=new w({wrapperField:e.wrapperField,type:i.data("type"),conditionQuestion:i.data("condition"),answerOption:i.data("option"),mandatory:i.data("mandatory"),value:i.data("value"),onFulfilled:function(t){e.onFulfilled(o,t)}})}))}},{key:"mustShow",value:function(){var e=Object.values(this.conditions),t=e.filter((function(e){return e.mandatory})),n=e.filter((function(e){return!e.mandatory}));return t.length?t.every((function(e){return e.fulfilled})):n.some((function(e){return e.fulfilled}))}},{key:"onFulfilled",value:function(e,t){this.conditions[e].fulfilled=t,this.mustShow()?this.showQuestion():this.hideQuestion()}},{key:"showQuestion",value:function(){this.wrapperField.fadeIn(),this.wrapperField.find("input, textarea").prop("disabled",null),this.showCount++}},{key:"hideQuestion",value:function(){this.showCount?this.wrapperField.fadeOut():this.wrapperField.hide(),this.wrapperField.find("input, textarea").prop("disabled","disabled")}}]),e}();function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var C=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};b(this,e),this.wrapperField=t.wrapperField,this.alertElement=t.alertElement,this.controllerFieldSelector=t.controllerFieldSelector,this.controllerCollectionSelector=t.controllerCollectionSelector,this.maxChoices=t.maxChoices,this.controllerSelector=this.wrapperField.find(this.controllerFieldSelector),this._bindEvent(),this._run()}var t,n,i;return t=e,(n=[{key:"_run",value:function(){var e=this,t=this.wrapperField.find(this.controllerCollectionSelector),n=!1;t.each((function(t,i){var o=$(i).find(e.controllerFieldSelector).filter((function(e,t){return $(t).is(":checked")}));n=n||o.length>e.maxChoices})),n?this.alertElement.show():this.alertElement.hide()}},{key:"_bindEvent",value:function(){var e=this;this.controllerSelector.on("change",(function(){e._run()}))}}])&&k(t.prototype,n),i&&k(t,i),e}();$((function(){$(".radio-button-collection, .check-box-collection").each((function(e,t){var n;n={wrapperField:$(t),controllerFieldSelector:"input[type=radio], input[type=checkbox]",dependentInputSelector:"input[type=text], input[type=hidden]"},new d(n)})),$.unique($(".check-box-collection").parents(".answer")).each((function(e,t){var n,i=$(t).data("max-choices");i&&(n={wrapperField:$(t),controllerFieldSelector:"input[type=checkbox]",controllerCollectionSelector:".check-box-collection",alertElement:$(t).find(".max-choices-alert"),maxChoices:i},new C(n))})),$(".sortable-check-box-collection").each((function(e,t){var n;n={wrapperField:$(t)},new p(n)})),$(".answer-questionnaire .question[data-conditioned='true']").each((function(e,t){var n;n={wrapperField:$(t)},new _(n)}));var e=$("form.answer-questionnaire");if(e.length>0){e.find("input, textarea, select").on("change",(function(){e.data("changed",!0)}));var t=e.data("safe-path").split("?")[0];$(document).on("click","a",(function(e){window.exitUrl=e.currentTarget.href})),$(document).on("submit","form",(function(e){window.exitUrl=e.currentTarget.action})),window.addEventListener("beforeunload",(function(n){var i=window.exitUrl,o=e.data("changed");window.exitUrl=null,!o||i&&i.includes(t)||(n.returnValue=!0)}))}})),n(12581)}()}();
//# sourceMappingURL=decidim_meetings-fce28aef201057314aa0.js.map